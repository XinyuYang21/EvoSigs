---
title: "EvoSig_estimate"
author: "XINYU YANG"
output: html_document

---
```{r}
   install
   library(EvoSigs)
```
## step 1: Prepare Cancer Cell Fraction(CCF) Distributions-by-Samples Matrix
Consider the following example, where the CCF distribution matrix for two samples is created and visualized using `ccf_dist_plot()` function:
```{r}
   # Example: Combine CCF distributions for two samples
   ccfMat = cbind(data("example_ccfMat_plot.rds"),data("example_ccfMat_plot.rds"))

   # Visualize the CCF distribution matrix
   ccf_dist_plot(ccfMat)
```
This matrix should have 100 rows representing bins between [0,1], and columns representing different samples.
```{r}
  # Display the dimensions of the CCF matrix
  dim(ccfMat)
```

## Step 2: Estimate Consensus Signatures of evolutionary dynamics (Esigs) Exposure Among Samples
You can either use existing consensus signatures of evolutionary dynamics for TCGA or customize your own. The system includes built-in signatures that can be loaded and visualized as follows:
```{r}
  # Load built-in consensus signatures for TCGA cohort
  consensus_sig_TCGA = data(consensus_sig_TCGA)

  # Visualize consensus signatures
  sig_plot(t(consensus_sig_TCGA))
  
   sigs_by_row = t(consensus_sig_TCGA)
```
### Step 3: Estimate Esigs Exposure Among Samples
Using the prepared ccfMat (in Step 1) and consensus signatures (in Step 2), measure exposure using `EvoSig_estimate()` function:
```{r}
  # Estimate Esigs exposure using the prepared data
  EvoSig_estimate(ccfMat_by_samples = ccfMat, consensus_sig = consensus_sig_TCGA)
```



